"""Vulnerability Reporter"""

import json
import logging
from typing import Dict, Any
from datetime import datetime

logger = logging.getLogger(__name__)


class VulnerabilityReporter:
    """Generate vulnerability reports"""
    
    def __init__(self, vulnerabilities: Dict, analysis: Dict):
        self.vulnerabilities = vulnerabilities
        self.analysis = analysis
        logger.info("Initialized VulnerabilityReporter")
        
    def generate_json_report(self, output_path: str):
        """Export comprehensive JSON report"""
        report = {
            'report_version': '1.0',
            'generated_at': datetime.now().isoformat(),
            'vulnerabilities': self.vulnerabilities,
            'analysis': self.analysis,
        }
        
        with open(output_path, 'w', encoding='utf-8') as f:
            json.dump(report, f, indent=2)
            
        logger.info(f"Vulnerability report saved to {output_path}")

